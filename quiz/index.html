<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <title>Tr·∫Øc nghi·ªám</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Noto Sans JP', 'Hiragino Kaku Gothic Pro', 'Meiryo', 'MS PGothic', sans-serif;
      max-width: 700px;
      margin: 2rem auto;
      padding: 1rem;
      background: #f0f0f0;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    .question-card {
      background: #fff;
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 1rem;
    }
    .options button {
      display: block;
      width: 100%;
      margin: 0.5rem 0;
      padding: 0.75rem;
      border: none;
      border-radius: 6px;
      background: #007bff;
      color: white;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s;
    }
    .options button:hover {
      background: #0056b3;
    }
    .correct {
      background-color: #28a745 !important;
    }
    .wrong {
      background-color: #dc3545 !important;
    }
    .disabled {
      pointer-events: none;
      opacity: 0.8;
    }
    #nextBtn {
      margin-top: 1rem;
      padding: 0.75rem 1.5rem;
      background-color: #6c757d;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 1rem;
      display: none;
    }
    #nextBtn:hover {
      background-color: #5a6268;
    }
    .result {
      font-size: 1.2rem;
      font-weight: bold;
      text-align: center;
      margin-top: 1rem;
    }
  </style>
</head>
<body>

  <h1>Tr·∫Øc Nghi·ªám</h1>

  <input type="file" id="fileInput" accept=".json" />

  <div id="quizContainer"></div>
  <div class="result" id="result"></div>
  <button id="nextBtn">C√¢u ti·∫øp theo</button>

  <script>
  let questions = [];
  let current = 0;
  let score = 0;
  let userAnswers = [];

  document.getElementById('fileInput').addEventListener('change', function(e) {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = function(event) {
      try {
        questions = JSON.parse(event.target.result);
        questions = questions.sort(() => Math.random() - 0.5); // Randomize question order
        current = 0;
        score = 0;
        userAnswers = [];
        document.getElementById('result').innerText = '';
        document.getElementById('nextBtn').style.display = 'none';
        showQuestion();
      } catch (err) {
        alert('File JSON kh√¥ng h·ª£p l·ªá');
      }
    };
    reader.readAsText(file);
  });

  function showQuestion() {
    const container = document.getElementById('quizContainer');
    container.innerHTML = '';
    document.getElementById('nextBtn').style.display = 'none';

    if (current >= questions.length) {
      showSummary();
      return;
    }

    const q = questions[current];
    const card = document.createElement('div');
    card.className = 'question-card';

    const question = document.createElement('div');
    question.innerText = `C√¢u ${current + 1}: ${q.question}`;
    question.style.fontWeight = 'bold';
    question.style.marginBottom = '1rem';

    const optionsDiv = document.createElement('div');
    optionsDiv.className = 'options';

    q.options.forEach(opt => {
      const btn = document.createElement('button');
      btn.innerText = opt;
      btn.onclick = () => {
        const isCorrect = (opt === q.answer);
        if (isCorrect) {
          btn.classList.add('correct');
          score++;
        } else {
          btn.classList.add('wrong');
          Array.from(optionsDiv.children).forEach(b => {
            if (b.innerText === q.answer) b.classList.add('correct');
          });
        }
        userAnswers.push({
          question: q.question,
          selected: opt,
          correct: q.answer,
          isCorrect: isCorrect
        });
        Array.from(optionsDiv.children).forEach(b => b.classList.add('disabled'));
        document.getElementById('nextBtn').style.display = 'block';
      };
      optionsDiv.appendChild(btn);
    });

    card.appendChild(question);
    card.appendChild(optionsDiv);
    container.appendChild(card);
  }

  function showSummary() {
    const container = document.getElementById('quizContainer');
    container.innerHTML = '';

    const resultText = document.createElement('div');
    resultText.className = 'result';
    resultText.innerText = `Ho√†n th√†nh! ƒêi·ªÉm s·ªë: ${score}/${questions.length}`;
    container.appendChild(resultText);

    userAnswers.forEach((ua, index) => {
      const card = document.createElement('div');
      card.className = 'question-card';

      const qText = document.createElement('div');
      qText.innerText = `C√¢u ${index + 1}: ${ua.question}`;
      qText.style.fontWeight = 'bold';
      card.appendChild(qText);

      const aText = document.createElement('div');
      aText.innerHTML = `
        ‚úÖ ƒê√°p √°n ƒë√∫ng: <strong>${ua.correct}</strong><br/>
        üß† B·∫°n ch·ªçn: <strong style="color:${ua.isCorrect ? 'green' : 'red'}">${ua.selected}</strong> 
        ${ua.isCorrect ? '‚úÖ ƒê√∫ng' : '‚ùå Sai'}
      `;
      aText.style.marginTop = '0.5rem';
      card.appendChild(aText);

      container.appendChild(card);
    });
  }

  document.getElementById('nextBtn').onclick = () => {
    current++;
    showQuestion();
  };
</script>


</body>
</html>
